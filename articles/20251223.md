---
title: "snapの中で迷子になるgit-remote-https"
description: "ghコマンドがgit-remote-httpsを叩けないのはsnapのせい"
date: 20251223
---
こんにちは。静カニです。久しぶりの技術記事です。この間、[manager.nvim](https://github.com/shizukani-cp/manager.nvim)に機能追加を行い、
その新機能を使いやすくするために新しいプラグインを作ろうとしていたのですが、ここで問題が発生しました。
※この記事は、[Qiita gitアドベントカレンダー 2025](https://qiita.com/advent-calendar/2025/git)に参加しています
## tl;dr
ghでgit-remote-httpsがうんたらとか言い出したらsnap版じゃなくてapt版入れろ
## 環境
とりあえず環境書いておきます


- OS: Zorin OS 18 Core(ベースはUbuntu 24.04)
- snap: 2.72
- apt: 2.8.3
- 元のgit&ghのバージョン: 不明。ただしgit2.52, gh2.83ぐらいだと思われる
## 問題発生
```bash
$ gh repo create
What would you like to do? Create a new repository on GitHub from scratch
Repository name manager-logs
Description 
Visibility Public
Would you like to add a README file? Yes
Would you like to add a .gitignore file? No
Would you like to add a license? Yes
Choose a license MIT license
This will create "manager-logs" as a public repository on GitHub. Continue? Yes
Clone the new repository locally? Yes

warning: templates not found in /usr/share/git-core/templates
git: 'remote-https' is not a git command. See 'git --help'.
failed to run git: exit status 128
```
という感じです。ちなみにPublicリポジトリを `gh repo clone` でクローンしようとしても同じエラー(警告)が出ます。
今の環境に移ってからというよりは、sshを始めてからこのエラーが出ていそうです。
さらにちなむと`git clone`でsshすると普通に出来ます。
とりあえず私の解決までの道のりはこんな感じです。
## 解決までの道のり


1. `ssh -T git@github.com` でssh自体の生存を確認
1. `gh config set git_protocol ssh`で強制的にsshを使わせる→ダメ
1. `gh auth refresh -s repo`で再認証→ダメ
1. 今のsshを登録するときに昔のsshがあったことに気付く→削除→ダメ
1. `~/.ssh/config`がないことに気付く→作成&記入→ダメ
1. git本体の再インストール(`sudo apt update && sudo apt remove git && sudo apt install git`)→ダメ
1. `which git`で場所確認→`/usr/bin/git`なので割と普通
1. その他関連ライブラリを入れる(`sudo apt install libcurl4-openssl-dev libssl-dev expat libexpat1-dev gettext`) →ダメ
1. エアーメッセージの`git-remote-https`がどこにあるか確認する
  (`find /usr -name "git-remote-https"`)→`/usr/lib/git-core/git-remote-https`にあったので標準的
1. `$PATH`に`/usr/lib/git-core`を追加する→ダメ
1. git側が参照してるのが違う説(`git --exec-path`)→`/usr/lib/git-core`なので同じ
1. snapから入れていたのをaptから入れ直す→出来た
## なんでこれでいけんの?
snapは隔離環境で動かしていて、中の世界にいるgit君が
外の世界にある`git-remote-https`にアクセスできなくて発狂していた模様。
一方でaptは、隔離していないため同じ世界にgh君とgit君と`git-remote-https`が同居しているからいけるっぽい。

なのでその他snapで入れていたバグっているものがあったらaptで入れ直してみるのもいい手かも。
