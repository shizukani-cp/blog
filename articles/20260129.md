---
title: "zcompile使ってて設定反映されなかったらzwcを消そう"
description: "nix移行してたらzwcのせいで反映されなかったのでその経験をそのまま記事にしたやつ"
date: 20260129
---
こんにちは。最近nix(home-manager)移行した静カニです。

nix移行の中でかなりつまずいたことがあるので紹介します。

## TL;DR
`.zshrc`の設定変更がうまくいかなかったら`.zshrc.zwc`の存在を疑え

## つまずいたこと
私はzshユーザーなのですが、何故かつまずきまくっていました。
それが、`.zshrc`を削除して`home-manager switch`(この頃はoh-my-poshとかも移行してない)しても
`oh-my-posh`抜きの環境にならない、という問題です。

## 失敗s


1. とりあえず`.zshrc`に変に設定が紛れ込んでないか調べる→紛れ込んでない
1. 元々の`.zshrc.bak`のせいを疑い、削除→元々通りに起動
1. `programs.zsh.enable`を一旦消してみる→元々通り
1. `.zshrc`から`.shopts`と`.shfunc`を元々呼んでいたので呼ばれていないか見る→呼ばれている
1. よし`.zshrc`のどこで呼ばれてるか見るか!→な い
1. しかもエラーメッセージに130行目とかあるから探すk…→130行もない(50行もなかった)
1. 地味にシステムのzshが悪さしてる気がしたので削除→shが起動→oh s\*\*t

画像は残っているわけがありません

## 成功
AI「`*.zwc`が消えていない可能性があるよ」
ワイ「`.zshrc.zwc`か…多分なi…あったわ。消すか。」
zsh「ほな標準のプロンプトにするで~」
ワイ「ｷﾀｰｰｰｰｰｰ!」

## まとめ
vim-jpで「『それ最初から言ってくれれば良かったのに~』というものを記事にするといい」
みたいな話を聞いた気がするのでやってみました。

みんなも`zcompile`使ってたら`*.zwc`疑ってみてね!
## 後日談
AI「nixだったら高速なので`zcompile`いらないよ」
ワイ「グッバイワイの`.shfunc`、フォーエバー`.shfunc`」
